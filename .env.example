# Database (Neon)
DATABASE_URL=postgresql://user:password@host:5432/dbname?sslmode=require

# Supabase Authentication
VITE_SUPABASE_URL=https://your-project.supabase.co
VITE_SUPABASE_ANON_KEY=your-anon-key

# Session
SESSION_SECRET=your-strong-session-secret-here

# ============================================================
# EPX PAYMENT PROCESSING - HOSTED CHECKOUT (SANDBOX + PROD)
# ============================================================

# --- Sandbox (default / certification) ---
EPX_PUBLIC_KEY=eyAidGVybWluYWxQcm9maWxlSWQiOiAiYjE1NjFjODAtZTgxZC00NTNmLTlkMDUtYTI2NGRjOTZiODhkIiB9
EPX_TERMINAL_PROFILE_ID=b1561c80-e81d-453f-9d05-a264dc96b88d
EPX_ENVIRONMENT=sandbox  # change to 'production' only when pointing at live EPX

# --- Production (values provided by EPX; copy into the vars above when going live) ---
EPX_PUBLIC_KEY_PRODUCTION=eyAidGVybWluYWxQcm9maWxlSWQiOiAiODBkODE2MjUtZmUwMC00N2JkLTg5YzktNjNjYTk4ZDdmZTkxIiB9
EPX_TERMINAL_PROFILE_ID_PRODUCTION=80d81625-fe00-47bd-89c9-63ca98d7fe91
EPX_WEBHOOK_SECRET=your_webhook_secret_here

# Google reCAPTCHA v3 (required by EPX)
RECAPTCHA_SECRET_KEY=your_google_recaptcha_secret_key_here
RECAPTCHA_SCORE_THRESHOLD=0.5  # Minimum score required (0.0 to 1.0)
EPX_LOG_DIR=./logs/epx  # Directory for EPX payment logs

# EPX Credentials (used for both Hosted Checkout and Server Post)
EPX_CUST_NBR=9001
EPX_DBA_NBR=2
EPX_MERCH_NBR=900300
EPX_TERMINAL_NBR=3
EPX_MAC=your_mac_key_here  # This is also called EPI-Key for Server Post

# ============================================================
# EPX RECURRING BILLING API - SERVER POST INTEGRATION
# ============================================================
# EPX Recurring Billing API enables automatic subscription management
# Separate from EPX Hosted Checkout (which handles initial enrollment)

# Enable recurring billing scheduler (default: false)
# Set to 'true' ONLY after setting up subscriptions in EPX system
BILLING_SCHEDULER_ENABLED=false
BILLING_SCHEDULER_INTERVAL_MINUTES=30
BILLING_SCHEDULER_MIN_AGE_MINUTES=10

# Optional override for MerchantAccountCode (defaults to DPCPRIMARY)
EPX_MERCHANT_ACCOUNT_CODE=DPCPRIMARY

# EPX Recurring Billing API URLs (automatically selected based on EPX_ENVIRONMENT)
# Sandbox: https://billing.epxuap.com
# Production: https://billing.epx.com

# EPI-Id is auto-constructed from: {EPX_CUST_NBR}-{EPX_MERCH_NBR}-{EPX_DBA_NBR}-{EPX_TERMINAL_NBR}
# Example: 9001-900300-2-72

# EPX_MAC is used as the API key (also called EPI-Key) for HMAC signature generation
# The same MAC key is used for both Hosted Checkout and Recurring Billing API

# Token capture feature (default: false)
# Enables capturing BRIC tokens after successful Hosted Checkout payments
# Tokens can be used for recurring billing via PreviousPayment option
EPX_CAPTURE_TOKENS=false

# ============================================================
# OTHER CONFIGURATION
# ============================================================

# Mock Payment Provider (for testing only)
# Set to 'mock' during development/testing
PAYMENT_PROVIDER=mock

# Application
NODE_ENV=production
PORT=3000

# Frontend URL for CORS
VITE_PUBLIC_URL=https://enrollment.getmydpc.com

# Email (optional - for lead notifications)
# Lead form submissions will send email to info@mypremierplans.com
EMAIL_SERVICE=gmail  # or 'outlook', 'yahoo', etc.
EMAIL_USER=your-email@gmail.com
EMAIL_PASSWORD=your-app-password  # Use app-specific password for Gmail
# Note: For Gmail, generate an app password at https://myaccount.google.com/apppasswords

# ============================================================
# EPX RECURRING BILLING SETUP NOTES
# ============================================================
#
# 1. Current system (Hosted Checkout) continues working without changes
# 
# 2. To enable recurring billing:
#    Step 1: Run database migration - node run_epx_recurring_migration.mjs
#    Step 2: Set BILLING_SCHEDULER_ENABLED=true
#    Step 3: Restart server
#
# 3. EPI-Id is auto-constructed: {EPX_CUST_NBR}.{EPX_DBA_NBR}.{EPX_MERCH_NBR}.{EPX_TERMINAL_NBR}
#    Example: 9001.2.900300.72
#
# 4. IMPORTANT: Contact EPX to whitelist your production IP before going live!
#
# ============================================================
